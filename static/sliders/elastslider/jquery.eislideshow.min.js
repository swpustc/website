(function(d,e,f){var a=e.event,c;a.special.smartresize={setup:function(){e(this).bind("resize",a.special.smartresize.handler)},teardown:function(){e(this).unbind("resize",a.special.smartresize.handler)},handler:function(j,g){var i=this,h=arguments;j.type="smartresize";if(c){clearTimeout(c)}c=setTimeout(function(){jQuery.event.handle.apply(i,h)},g==="execAsap"?0:100)}};e.fn.smartresize=function(g){return g?this.bind("smartresize",g):this.trigger("smartresize",["execAsap"])};e.Slideshow=function(g,h){this.$el=e(h);this.$list=this.$el.find("ul.ei-slider-large");this.$imgItems=this.$list.children("li");this.itemsCount=this.$imgItems.length;this.$images=this.$imgItems.find("img:first");this.$sliderthumbs=this.$el.find("ul.ei-slider-thumbs").hide();this.$sliderElems=this.$sliderthumbs.children("li");this.$sliderElem=this.$sliderthumbs.children("li.ei-slider-element");this.$thumbs=this.$sliderElems.not(".ei-slider-element");this._init(g)};e.Slideshow.defaults={animation:"sides",autoplay:false,slideshow_interval:3000,speed:800,easing:"",titlesFactor:0.6,titlespeed:800,titleeasing:"",thumbMaxWidth:190};e.Slideshow.prototype={_init:function(h){this.options=e.extend(true,{},e.Slideshow.defaults,h);this.$imgItems.css("opacity",0);this.$imgItems.find("div.ei-title > *").css("opacity",0);this.current=0;var g=this;this.$loading=e('<div class="ei-slider-loading">Loading</div>').prependTo(g.$el);e.when(this._preloadImages()).done(function(){g.$loading.hide();g._setImagesSize();g._initThumbs();g.$imgItems.eq(g.current).css({"opacity":1,"z-index":10}).show().find("div.ei-title > *").css("opacity",1);if(g.options.autoplay){g._startSlideshow()}g._initEvents()})},_preloadImages:function(){var g=this,h=0;return e.Deferred(function(i){g.$images.each(function(m){var l=e(this),j=l.attr("data-src"),k=l.attr("src"),n=j?j:k;e("<img/>").load(function(){if(++h===g.itemsCount){i.resolve()}}).attr("src",n)})}).promise()},_setImagesSize:function(){this.elWidth=this.$el.width();var g=this;this.$images.each(function(m){var l=e(this),h=l.attr("data-src"),j=l.attr("src");if(h){j=h;l.attr("src",j)}var k=g._getImageDim(j);l.css({width:k.width,height:k.height,marginLeft:k.left,marginTop:k.top})})},_getImageDim:function(g){var h=new Image();h.src=g;var l=this.elWidth,r=this.$el.height(),o=r/l,p=h.width,k=h.height,j=k/p,q,m,n,i;if(o>j){m=r;q=r/j}else{m=l*j;q=l}return{width:q,height:m,left:(l-q)/2,top:(r-m)/2}},_initThumbs:function(){this.$sliderElems.css({"max-width":this.options.thumbMaxWidth+"px","width":100/this.itemsCount+"%"});this.$sliderthumbs.css("max-width",this.options.thumbMaxWidth*this.itemsCount+"px").show()},_startSlideshow:function(){var g=this;this.slideshow=setTimeout(function(){var h;(g.current===g.itemsCount-1)?h=0:h=g.current+1;g._slideTo(h);if(g.options.autoplay){g._startSlideshow()}},this.options.slideshow_interval)},_slideTo:function(l){if(l===this.current||this.isAnimating){return false}this.isAnimating=true;var k=this.$imgItems.eq(this.current),h=this.$imgItems.eq(l),g=this,j={zIndex:10},i={opacity:1};if(this.options.animation==="sides"){j.left=(l>this.current)?-1*this.elWidth:this.elWidth;i.left=0}h.find("div.ei-title > h2").css("margin-right",50+"px").stop().delay(this.options.speed*this.options.titlesFactor).animate({marginRight:0+"px",opacity:1},this.options.titlespeed,this.options.titleeasing).end().find("div.ei-title > h3").css("margin-right",-50+"px").stop().delay(this.options.speed*this.options.titlesFactor).animate({marginRight:0+"px",opacity:1},this.options.titlespeed,this.options.titleeasing);e.when(k.css("z-index",1).find("div.ei-title > *").stop().fadeOut(this.options.speed/2,function(){e(this).show().css("opacity",0)}),h.css(j).stop().animate(i,this.options.speed,this.options.easing),this.$sliderElem.stop().animate({left:this.$thumbs.eq(l).position().left},this.options.speed)).done(function(){k.css("opacity",0).find("div.ei-title > *").css("opacity",0);g.current=l;g.isAnimating=false})},_initEvents:function(){var g=this;e(d).on("smartresize.eislideshow",function(h){g._setImagesSize();g.$sliderElem.css("left",g.$thumbs.eq(g.current).position().left)});this.$thumbs.on("click.eislideshow",function(i){if(g.options.autoplay){clearTimeout(g.slideshow);g.options.autoplay=false}var j=e(this),h=j.index()-1;g._slideTo(h);return false})}};var b=function(g){if(this.console){console.error(g)}};e.fn.eislideshow=function(h){if(typeof h==="string"){var g=Array.prototype.slice.call(arguments,1);this.each(function(){var i=e.data(this,"eislideshow");if(!i){b("cannot call methods on eislideshow prior to initialization; "+"attempted to call method '"+h+"'");return}if(!e.isFunction(i[h])||h.charAt(0)==="_"){b("no such method '"+h+"' for eislideshow instance");return}i[h].apply(i,g)})}else{this.each(function(){var i=e.data(this,"eislideshow");if(!i){e.data(this,"eislideshow",new e.Slideshow(h,this))}})}return this}})(window,jQuery);
